#!/bin/bash -e

# Type `:CheckHealth` to check installed modules.
. ~/dotfiles/bin/dffunc
require dfdeploy

dfx sudo apt-add-repository -y ppa:neovim-ppa/unstable
aptupdate
aptinstall git libclang-dev python-dev python-pip python3-dev python3-pip ruby-dev neovim
dfx sudo -H pip2 install neovim
dfx sudo -H pip3 install neovim
dfx sudo -H gem install neovim

dfx . ~/dotfiles/bin/dfnvim-alternatives /usr/bin/nvim

dir=$HOME/.cache/dein/repos/github.com/Shougo/dein.vim
if [ -d "$dir" ]; then
    dfx cd "$dir"
    dfx git pull
else
    dfx git clone https://github.com/Shougo/dein.vim \
        "$HOME/.cache/dein/repos/github.com/Shougo/dein.vim" --depth 1
fi

dfout2 "Please type :call dein#install() and :UpdateRemotePlugins in" \
    "Neovim manually after installation."

finalize dfnvim

